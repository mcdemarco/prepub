(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
window.onload=function(){void 0===window.PrePub&&(window.PrePub={convert:function(){var t=this.export(),e=new Blob([t],{type:"text/markdown;charset=utf-8"});saveAs(e,"prepub"+Date.now()+".md")},export:function(){var t=[],e=window.document.getElementsByTagName("tw-storydata");e&&t.push(this.buildPassage("StoryTitle","",e[0].getAttribute("name")));for(var n=window.document.getElementsByTagName("tw-passagedata"),r=0;r<n.length;++r)t.push(this.buildPassageFromElement(n[r]));return t.join("")},buildPassageFromElement:function(t){var e=t.getAttribute("name");e||(e="Untitled Passage");var n=t.textContent;return this.buildPassage(e,n)},buildPassage:function(t,e){var n=[];return n.push("## ",t),n.push("\r\n",this.scrub(e),"\r\n\r\n"),n.join("")},markdownLinks:function(t){return t.replace(/\[\[(.*?)\]\]/g,function(t,e){var n,r=e.indexOf("|");if(-1!=r)n=e.substr(0,r),e=e.substr(r+1);else{var s=e.indexOf("->");if(-1!=s)n=e.substr(0,s),e=e.substr(s+2);else{var a=e.indexOf("<-");-1!=a&&(n=e.substr(a+2),e=e.substr(0,a))}}return n?"["+n+"]["+e+"]":"["+e+"]"})},scrub:function(t){return t&&(t=t.replace(/^##/gm," ##"),t=t.replace(/\\</gm,"&lt;"),t=t.replace(/\\>/gm,"&gt;"),t=this.markdownLinks(t)),t}}),window.PrePub.convert()};
},{}]},{},[1]);
